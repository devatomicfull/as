= Projeto Android CameraX - Guia Completo

v1.0, Julho 2025

:toc: left
:toclevels: 3
:icons: font
:source-highlighter: highlightjs

== üìë Sum√°rio Geral

[cols="1,1"]
|===
| *T√≥pico* | *Subt√≥pico / Link*

| 1. CameraX : Este projeto utiliza a API moderna *CameraX* do Android Jetpack para realizar captura de imagens
| - <a id="app1"></a>App1: Captura com Preview

| 2. Camera1
| - <a id="app2"></a>App2: Captura -- >
|===

== T√≥pico: API - CameraX

Suporte a ciclo de vida, preview e execu√ß√£o em segundo plano. A aplica√ß√£o est√° preparada para trabalhar com permiss√µes din√¢micas e escrita de arquivos locais. </a>

== üì¶ Pacotes Importantes

O projeto faz uso das seguintes bibliotecas e pacotes:

androidx
- `camera.core`
- `camera.lifecycle`
- `camera.view`
- `activity.result`
- 'core.content`

java
- `util.concurrent`

android
- `os`
- `content`
- `Manifest`
- `widget`

== Classes Usadas

|===
| Classe | Fun√ß√£o

| `PreviewView`
| Componente visual para exibir a c√¢mera no layout.

| `ActivityResultLauncher<I>`
| Abstra√ß√£o moderna para solicitar permiss√µes ou resultados de atividades.

| `ActivityResultContracts`
| Contratos prontos para uso com `ActivityResultLauncher`, como `RequestPermission`.

| `ContextCompat`
| Verifica√ß√£o de permiss√µes de forma compat√≠vel com vers√µes anteriores do Android.

| `PackageManager`
| Usado para verificar se a permiss√£o foi concedida.

| `Manifest`
| Cont√©m constantes como `Manifest.permission.CAMERA`.

| `File`
| Representa o arquivo de imagem salvo localmente.

| `ImageCapture`
| Caso de uso da API CameraX para capturar imagens.

| `ImageCapture.OnImageSavedCallback`
| Interface de callback para sucesso ou erro durante salvamento da imagem.

| `LifecycleOwner`
| Interface implementada por `Activity`/`Fragment` para suportar binding da c√¢mera ao ciclo de vida.

| `Context`
| Contexto da aplica√ß√£o, necess√°rio para instanciar diversos componentes Android.

| `ExecutorService`
| Executor de thread √∫nica utilizado para rodar opera√ß√µes da c√¢mera em segundo plano.

| `LifecycleCameraController`
| Controlador simplificado da c√¢mera baseado em ciclo de vida, fornece suporte integrado ao preview e captura.

| `CameraSelector`
| Permite escolher qual c√¢mera utilizar (frontal, traseira).
|===

== üìö T√≥pico: CameraX

=== <a id="app1"></a>Subt√≥pico: App1 - Captura com Preview

Demonstra√ß√£o do uso b√°sico da API `CameraX` com preview ao vivo via `PreviewView` e captura de imagens com `ImageCapture`.

[cols="1a", options="header"]
|===
| Interface do App

| image::camerax_img/app1.png[width=300, alt="Preview da c√¢mera"]
|===

== üìñ Descri√ß√£o Geral do Projeto

Este aplicativo demonstra o uso b√°sico da API CameraX para capturar fotos, exibindo a visualiza√ß√£o da c√¢mera diretamente na interface por meio do `PreviewView`. Tamb√©m utiliza `ActivityResultLauncher` para solicitar permiss√µes de forma moderna e segura.

=== ‚öôÔ∏è Componentes principais

- Interface visual com bot√£o de captura.
- Controle da c√¢mera encapsulado via classe `CameraHelper`.
- Salvamento de imagens em diret√≥rio interno do app.
- Toasts para feedback de sucesso ou falha.
- Gerenciamento adequado de ciclo de vida.

=== üìÇ Nome do App

[source,java]
----
‚îú‚îÄ‚îÄ cameraxsample
----

== ‚úÖ Regras e Requisitos para Funcionamento

=== Regra 1 - Permiss√£o de c√¢mera
A permiss√£o `Manifest.permission.CAMERA` deve ser concedida pelo usu√°rio em tempo de execu√ß√£o, ou a c√¢mera n√£o ser√° iniciada.

=== Regra 2 - Uso do ciclo de vida
A c√¢mera s√≥ ser√° iniciada quando a `Activity` ou `Fragment` for um `LifecycleOwner`, garantindo que o CameraX respeite os eventos como `onCreate`, `onDestroy`, etc.

=== Regra 3 - Diret√≥rio de armazenamento
As imagens s√£o salvas em:  
`getExternalFilesDir(null)`  
Este diret√≥rio √© privado do app e n√£o requer permiss√£o de armazenamento.

=== Regra 4 - Encerramento correto do executor
Para evitar vazamentos de mem√≥ria (memory leaks), o m√©todo `cameraHelper.encerrar()` deve ser chamado no `onDestroy()` da `Activity`.

=== Regra 5 - Interface responsiva
As intera√ß√µes com a UI ap√≥s a captura (exibi√ß√£o de `Toast`, etc.) devem sempre ser feitas com `runOnUiThread()` para manter a estabilidade da interface.

== üõ†Ô∏è Requisitos T√©cnicos

- SDK m√≠nimo: API 21 (Lollipop)
- SDK alvo: API 34 (Upside Down Cake)
- Gradle Plugin: 8.0+
- Permiss√µes declaradas no `AndroidManifest.xml` : tag < uses-permissions />

== üì¶ Depend√™ncias no build.gradle

[source,kotlin]
----
dependencies {
    implementation 'androidx.camera:camera-core:1.3.1'
    implementation 'androidx.camera:camera-lifecycle:1.3.1'
    implementation 'androidx.camera:camera-view:1.3.1'
    implementation 'androidx.core:core:1.12.0'
}
----

== üìû Contato e Contribui√ß√µes

Caso tenha d√∫vidas ou queira contribuir, envie uma mensagem ou abra um pull request.

